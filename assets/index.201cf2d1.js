(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerpolicy&&(c.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?c.credentials="include":t.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(t){if(t.ep)return;t.ep=!0;const c=n(t);fetch(t.href,c)}})();const _=e=>fetch(e),P=8,v=async e=>{const r=`https://cep.awesomeapi.com.br/json/${e}`,n=`https://brasilapi.com.br/api/cep/v2/${e}`;try{if(e.length!==P)throw new Error("CEP inv\xE1lido");const t=await(await Promise.any([_(r),_(n)])).json();if(!t.address)throw new Error("CEP n\xE3o encontrado");return`${t.address} - ${t.district} - ${t.city} - ${t.state}`}catch{return"CEP n\xE3o encontrado"}},S=async e=>fetch(`https://api.mercadolibre.com/sites/MLB/search?q=${e}`),b=async e=>fetch(`https://api.mercadolibre.com/items/${e}`),y=async e=>{try{return await(await b(e)).json()}catch{throw new Error("ID n\xE3o informado")}},L=async e=>{if(e)return(await(await S(e)).json()).results;throw new Error("Termo de busca n\xE3o informado")},i=()=>{const e=localStorage.getItem("cartProducts");return e?JSON.parse(e):[]},I=e=>{if(!e)throw new Error("Voc\xEA deve fornecer um ID");const n=[...i(),e];localStorage.setItem("cartProducts",JSON.stringify(n))},N=e=>{if(!e)throw new Error("Voc\xEA deve fornecer um ID");const n=i().filter(o=>o!==e);localStorage.setItem("cartProducts",JSON.stringify(n))},p=e=>{const r=document.createElement("img");return r.className="product__image",r.src=e.replace("I.jpg","O.jpg"),r},a=(e,r,n="")=>{const o=document.createElement(e);return o.className=r,o.innerText=n,o},q=(e,r)=>{e.remove(),N(r)},$=({id:e,title:r,price:n,pictures:o})=>{const t=document.createElement("li");t.className="cart__product";const c=a("div","cart__product__image-container"),s=p(o[0].url);c.appendChild(s);const u=p((o[1]||o[0]).url);c.appendChild(u),t.appendChild(c);const l=a("div","cart__product__info-container");l.appendChild(a("span","product__title",r));const f=a("span","product__price","R$ ");f.appendChild(a("span","product__price__value",n)),l.appendChild(f),t.appendChild(l);const E=a("i","material-icons cart__product__remove","delete");return t.appendChild(E),t.addEventListener("click",()=>q(t,e)),t},O=({id:e,title:r,thumbnail:n,price:o})=>{const t=document.createElement("section");t.className="product",t.appendChild(a("span","product__id",e));const c=a("div","img__container");c.appendChild(p(n)),t.appendChild(c),t.appendChild(a("span","product__title",r));const s=a("span","product__price","R$ ");s.appendChild(a("span","product__price__value",o)),t.appendChild(s);const u=a("button","product__add","Adicionar ao carrinho!");return t.appendChild(u),t};const T=document.querySelector("#search-products"),D=document.querySelector("#products-input"),d=document.querySelector(".products"),j=document.querySelector(".total-price"),C=document.querySelector(".cart__products"),A=document.querySelector(".cep-input"),k=document.querySelector(".cep-button.cart-button"),x=document.querySelector(".cart__address");k.addEventListener("click",async()=>{x.innerText=await v(A.value)});const m=document.createElement("h2");m.innerHTML="carregando...";m.className="loading";d.appendChild(m);async function g(e){const r=await y(e),n=$(r);C.appendChild(n)}async function h(){const r=(await Promise.all(i().map(async n=>(await y(n)).price))).reduce((n,o)=>n+o,0);j.innerText=r}C.addEventListener("click",async()=>h());const w=async e=>{try{const r=await L(e);d.innerHTML="",r.forEach(o=>{d.appendChild(O(o))}),document.querySelectorAll(".product__add").forEach(o=>{o.addEventListener("click",async({target:t})=>{const{innerText:c}=t.parentElement.firstElementChild;await g(c),I(c),h()})})}catch{const n=document.createElement("h2");n.innerHTML="Algum erro ocorreu, recarregue a p\xE1gina e tente novamente",n.className="error",d.appendChild(n)}};window.onload=async()=>{await w("computador"),i().forEach(async r=>{await g(r)}),await h()};T.addEventListener("click",async()=>{await w(D.value)});
